# WeixinMPTools
WeixinMPTools 三合一小工具
# 公众号工具集

一款专为微信公众号运营者打造的多功能桌面工具，
支持双封面图片拼接 封面图提取 图片压缩。
作者：SoraKaGe_MeiOu | 主页：https://github.com/SorakageMeiou
---

## 📌 功能概览

### 1. 图片拼接
- 支持将两张图片按固定比例（上方 2.35:1，下方 1:1）进行裁剪并垂直拼接。
- 可选择白色或透明背景。
- 提供交互式裁剪区域绘制，所见即所得预览。

### 2. 封面图提取
- 输入任意微信公众号文章链接，自动解析并提取封面图。
- 自动复制图片链接到剪贴板。
- 自动下载封面图至程序所在目录，文件名格式为 cover_YYYYMMDD_HHMMSS.jpg。

### 3. 图片压缩
- 单文件压缩：选择单张图片，指定压缩质量（10–100），智能判断是否需压缩。
- 批量压缩：支持整个文件夹（含子目录）内所有图片批量处理。
- PNG 策略：
  - 自动转为 JPEG：提升压缩率（推荐用于无透明需求的场景）。
  - 保持 PNG 格式：保留透明通道。
- 自动跳过已小于设定大小（默认 10MB）的图片，避免无效操作。

---

## 🛠️ 使用说明

### 运行环境
- Python 3.7+
- 依赖库：tkinter, Pillow, requests, pyperclip

### 安装依赖（如未打包为可执行文件）
# 安装核心依赖库
pip install pillow requests pyperclip

### 启动方式
- 若为源码：运行 python WeixinMPTools.py
- 若为打包程序：直接双击 .exe 文件即可

### 操作指引
#### 图片拼接
1. 分别选择“上方图”和“下方图”。
2. 点击“开始裁剪”，在预览画布上拖拽绘制裁剪框（自动锁定比例）。
3. 点击“应用裁剪”确认。
4. 设置背景色后点击“执行拼接”。
5. 点击“保存图片”导出结果。

#### 封面图提取
1. 粘贴完整的微信公众号文章 URL（格式示例：https://mp.weixin.qq.com/s?xxxx）。
2. 点击“提取封面图”。
3. 链接自动复制，图片自动下载至程序目录。

⚠️ 注意：仅支持标准微信公众号文章页面（非小程序、非第三方跳转链接）。

#### 图片压缩
- 单文件：选择图片 → 调整质量滑块（10-100）→ 点击“开始压缩”。
- 批量：选择文件夹 → 勾选“包含子目录”（可选）→ 点击“批量压缩”。

压缩后的文件会自动添加 _compressed_q{质量值} 后缀（例：example_compressed_q80.jpg），原始文件不受影响。

### 📂 输出示例
- 封面图：cover_20251119_123045.jpg
- 压缩图：banner_compressed_q75.jpg
- 拼接图：combined_image_20251119.jpg

---

## ❓ 常见问题
Q：裁剪时无法绘制矩形？
A：请先点击“开始裁剪”按钮激活绘制模式，裁剪框会自动锁定预设比例。

Q：提取封面图失败？
A：请确保链接是微信官方文章页（以 https://mp.weixin.qq.com/s? 开头），部分开启防盗链的文章可能无法提取。

Q：压缩后图片体积未变小？
A：原始图片若已小于 10MB（默认阈值）会自动跳过，可手动调整阈值或降低压缩质量。

Q：PNG 图片压缩后透明背景丢失？
A：需在压缩时选择“保持 PNG 格式”，选择“自动转为 JPEG”会将透明背景转为白色。

---

## 📬 联系作者
- bilibili：https://space.bilibili.com/366462635
- GitHub：https://github.com/SorakageMeiou

如遇 Bug 或有功能建议，欢迎在提交 Issue 反馈！
